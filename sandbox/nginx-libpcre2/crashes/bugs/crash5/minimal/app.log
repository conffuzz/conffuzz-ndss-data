[I] Attempting to instrument callback ngx_regex_malloc
[E] {instrumentation.cpp:469} Got function argument numbers (2) from cache!
[I] Attempting to instrument callback ngx_regex_free
[E] {instrumentation.cpp:469} Got function argument numbers (2) from cache!
=================================================================
==1516==ERROR: AddressSanitizer: attempting free on address which was not malloc()-ed: 0x60200000112b in thread T0
    #0 0x7fffe137b517 in __interceptor_free ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:127
    #1 0x5555556a6a92 in ngx_regex_free src/core/ngx_regex.c:519
    #2 0x7fffe11857d7 in pcre2_general_context_free_8 src/pcre2_context.c:285
    #3 0x5555556a59de in ngx_regex_compile src/core/ngx_regex.c:152
    #4 0x55555570d802 in ngx_http_regex_compile src/http/ngx_http_variables.c:2494
    #5 0x5555556cc213 in ngx_http_core_server_name src/http/ngx_http_core_module.c:4294
    #6 0x555555622bb0 in ngx_conf_handler src/core/ngx_conf_file.c:463
    #7 0x555555621bcd in ngx_conf_parse src/core/ngx_conf_file.c:319
    #8 0x5555556c01db in ngx_http_core_server src/http/ngx_http_core_module.c:2892
    #9 0x555555622bb0 in ngx_conf_handler src/core/ngx_conf_file.c:463
    #10 0x555555621bcd in ngx_conf_parse src/core/ngx_conf_file.c:319
    #11 0x5555556a83c2 in ngx_http_block src/http/ngx_http.c:239
    #12 0x555555622bb0 in ngx_conf_handler src/core/ngx_conf_file.c:463
    #13 0x555555621bcd in ngx_conf_parse src/core/ngx_conf_file.c:319
    #14 0x55555561793c in ngx_init_cycle src/core/ngx_cycle.c:284
    #15 0x5555555c76b0 in main src/core/nginx.c:292
    #16 0x7fffe065dd8f  (/lib/x86_64-linux-gnu/libc.so.6+0x29d8f)
    #17 0x7fffe065de3f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x29e3f)
    #18 0x5555555c7024 in _start (/root/nginx-1.21.6/objs/nginx+0x73024)

0x60200000112b is located 5 bytes to the left of 9-byte region [0x602000001130,0x602000001139)
freed by thread T0 here:
    #0 0x7fffe137b517 in __interceptor_free ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:127
    #1 0x7fffe0c4fecb in CRYPTO_free crypto/mem.c:312
    #2 0x7fffe0ae688b in value_free_stack_doall crypto/conf/conf_api.c:180
    #3 0x7fffe0c48a2d in doall_util_fn crypto/lhash/lhash.c:198
    #4 0x7fffe0c48a87 in OPENSSL_LH_doall crypto/lhash/lhash.c:206
    #5 0x7fffe0ae5af2 in lh_CONF_VALUE_doall include/openssl/conf.h:31
    #6 0x7fffe0ae66ca in _CONF_free_data crypto/conf/conf_api.c:157
    #7 0x7fffe0ae6ef0 in def_destroy_data crypto/conf/conf_def.c:152
    #8 0x7fffe0ae6e99 in def_destroy crypto/conf/conf_def.c:141
    #9 0x7fffe0aeb93d in NCONF_free crypto/conf/conf_lib.c:197
    #10 0x7fffe0aec870 in CONF_modules_load_file crypto/conf/conf_mod.c:143
    #11 0x7fffe0aee0e5 in openssl_config_int crypto/conf/conf_sap.c:69
    #12 0x7fffe0c424fb in ossl_init_config crypto/init.c:293
    #13 0x7fffe0c424d8 in ossl_init_config_ossl_ crypto/init.c:291
    #14 0x7fffe06cdf67  (/lib/x86_64-linux-gnu/libc.so.6+0x99f67)

previously allocated by thread T0 here:
    #0 0x7fffe137b867 in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7fffe0c4fc6a in CRYPTO_malloc crypto/mem.c:222
    #2 0x7fffe0c6a0a7 in CRYPTO_strdup crypto/o_str.c:33
    #3 0x7fffe0ae8262 in def_load_bio crypto/conf/conf_def.c:403
    #4 0x7fffe0ae6fb1 in def_load crypto/conf/conf_def.c:174
    #5 0x7fffe0aeba60 in NCONF_load crypto/conf/conf_lib.c:214
    #6 0x7fffe0aec7f5 in CONF_modules_load_file crypto/conf/conf_mod.c:129
    #7 0x7fffe0aee0e5 in openssl_config_int crypto/conf/conf_sap.c:69
    #8 0x7fffe0c424fb in ossl_init_config crypto/init.c:293
    #9 0x7fffe0c424d8 in ossl_init_config_ossl_ crypto/init.c:291
    #10 0x7fffe06cdf67  (/lib/x86_64-linux-gnu/libc.so.6+0x99f67)

SUMMARY: AddressSanitizer: bad-free ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:127 in __interceptor_free
==1516==ABORTING
