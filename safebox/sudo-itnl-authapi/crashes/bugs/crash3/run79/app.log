Type list: passwd* char***
   passwd*->48
   char***->8
Type list: passwd* char* sudo_auth* sudo_conv_callback*
   passwd*->48
   char*->1
   sudo_auth*->80
   sudo_conv_callback*->32
Type list: passwd* int
   passwd*->48
   int->0
Type list: passwd* sudo_auth*
   passwd*->48
   sudo_auth*->80
Type list: passwd* _Bool
   passwd*->48
   _Bool->0
Type list: passwd* sudo_auth* _Bool
   passwd*->48
   sudo_auth*->80
   _Bool->0
Type list: passwd*
   passwd*->48
Type list: passwd* int _Bool
   passwd*->48
   int->0
   _Bool->0
Type list: passwd* char***
   passwd*->48
   char***->8
Type list: passwd* char* sudo_auth* sudo_conv_callback*
   passwd*->48
   char*->1
   sudo_auth*->80
   sudo_conv_callback*->32
Type list: passwd* int
   passwd*->48
   int->0
Type list: passwd* sudo_auth*
   passwd*->48
   sudo_auth*->80
Type list: passwd* _Bool
   passwd*->48
   _Bool->0
Type list: passwd* sudo_auth* _Bool
   passwd*->48
   sudo_auth*->80
   _Bool->0
Type list: passwd*
   passwd*->48
Type list: passwd* int _Bool
   passwd*->48
   int->0
   _Bool->0
Type list: passwd* char***
   passwd*->48
   char***->8
Type list: passwd* char* sudo_auth* sudo_conv_callback*
   passwd*->48
   char*->1
   sudo_auth*->80
   sudo_conv_callback*->32
Type list: passwd* int
   passwd*->48
   int->0
Type list: passwd* sudo_auth*
   passwd*->48
   sudo_auth*->80
Type list: passwd* _Bool
   passwd*->48
   _Bool->0
Type list: passwd* sudo_auth* _Bool
   passwd*->48
   sudo_auth*->80
   _Bool->0
Type list: passwd*
   passwd*->48
Type list: passwd* int _Bool
   passwd*->48
   int->0
   _Bool->0
Type list: passwd* char***
   passwd*->48
   char***->8
Type list: passwd* char* sudo_auth* sudo_conv_callback*
   passwd*->48
   char*->1
   sudo_auth*->80
   sudo_conv_callback*->32
Type list: passwd* int
   passwd*->48
   int->0
Type list: passwd* sudo_auth*
   passwd*->48
   sudo_auth*->80
Type list: passwd* _Bool
   passwd*->48
   _Bool->0
Type list: passwd* sudo_auth* _Bool
   passwd*->48
   sudo_auth*->80
   _Bool->0
Type list: passwd*
   passwd*->48
Type list: passwd* int _Bool
   passwd*->48
   int->0
   _Bool->0
Type list: passwd* char***
   passwd*->48
   char***->8
Type list: passwd* char* sudo_auth* sudo_conv_callback*
   passwd*->48
   char*->1
   sudo_auth*->80
   sudo_conv_callback*->32
Type list: passwd* int
   passwd*->48
   int->0
Type list: passwd* sudo_auth*
   passwd*->48
   sudo_auth*->80
Type list: passwd* _Bool
   passwd*->48
   _Bool->0
Type list: passwd* sudo_auth* _Bool
   passwd*->48
   sudo_auth*->80
   _Bool->0
Type list: passwd*
   passwd*->48
Type list: passwd* int _Bool
   passwd*->48
   int->0
   _Bool->0
Type list: passwd* char***
   passwd*->48
   char***->8
Type list: passwd* char* sudo_auth* sudo_conv_callback*
   passwd*->48
   char*->1
   sudo_auth*->80
   sudo_conv_callback*->32
Type list: passwd* int
   passwd*->48
   int->0
Type list: passwd* sudo_auth*
   passwd*->48
   sudo_auth*->80
Type list: passwd* _Bool
   passwd*->48
   _Bool->0
Type list: passwd* sudo_auth* _Bool
   passwd*->48
   sudo_auth*->80
   _Bool->0
Type list: passwd*
   passwd*->48
Type list: passwd* int _Bool
   passwd*->48
   int->0
   _Bool->0
Type list: passwd* char***
   passwd*->48
   char***->8
Type list: passwd* char* sudo_auth* sudo_conv_callback*
   passwd*->48
   char*->1
   sudo_auth*->80
   sudo_conv_callback*->32
Type list: passwd* int
   passwd*->48
   int->0
Type list: passwd* sudo_auth*
   passwd*->48
   sudo_auth*->80
Type list: passwd* _Bool
   passwd*->48
   _Bool->0
Type list: passwd* sudo_auth* _Bool
   passwd*->48
   sudo_auth*->80
   _Bool->0
Type list: passwd*
   passwd*->48
Type list: passwd* int _Bool
   passwd*->48
   int->0
   _Bool->0
Type list: passwd* char***
   passwd*->48
   char***->8
Type list: passwd* char* sudo_auth* sudo_conv_callback*
   passwd*->48
   char*->1
   sudo_auth*->80
   sudo_conv_callback*->32
Type list: passwd* int
   passwd*->48
   int->0
Type list: passwd* sudo_auth*
   passwd*->48
   sudo_auth*->80
Type list: passwd* _Bool
   passwd*->48
   _Bool->0
Type list: passwd* sudo_auth* _Bool
   passwd*->48
   sudo_auth*->80
   _Bool->0
Type list: passwd*
   passwd*->48
Type list: passwd* int _Bool
   passwd*->48
   int->0
   _Bool->0
Type list: passwd* char***
   passwd*->48
   char***->8
Type list: passwd* char* sudo_auth* sudo_conv_callback*
   passwd*->48
   char*->1
   sudo_auth*->80
   sudo_conv_callback*->32
Type list: passwd* int
   passwd*->48
   int->0
Type list: passwd* sudo_auth*
   passwd*->48
   sudo_auth*->80
Type list: passwd* _Bool
   passwd*->48
   _Bool->0
Type list: passwd* sudo_auth* _Bool
   passwd*->48
   sudo_auth*->80
   _Bool->0
Type list: passwd*
   passwd*->48
Type list: passwd* int _Bool
   passwd*->48
   int->0
   _Bool->0
Type list: passwd* char***
   passwd*->48
   char***->8
Type list: passwd* char* sudo_auth* sudo_conv_callback*
   passwd*->48
   char*->1
   sudo_auth*->80
   sudo_conv_callback*->32
Type list: passwd* int
   passwd*->48
   int->0
Type list: passwd* sudo_auth*
   passwd*->48
   sudo_auth*->80
Type list: passwd* _Bool
   passwd*->48
   _Bool->0
Type list: passwd* sudo_auth* _Bool
   passwd*->48
   sudo_auth*->80
   _Bool->0
Type list: passwd*
   passwd*->48
Type list: passwd* int _Bool
   passwd*->48
   int->0
   _Bool->0
Type list: passwd* char***
   passwd*->48
   char***->8
Type list: passwd* char* sudo_auth* sudo_conv_callback*
   passwd*->48
   char*->1
   sudo_auth*->80
   sudo_conv_callback*->32
Type list: passwd* int
   passwd*->48
   int->0
Type list: passwd* sudo_auth*
   passwd*->48
   sudo_auth*->80
Type list: passwd* _Bool
   passwd*->48
   _Bool->0
Type list: passwd* sudo_auth* _Bool
   passwd*->48
   sudo_auth*->80
   _Bool->0
Type list: passwd*
   passwd*->48
Type list: passwd* int _Bool
   passwd*->48
   int->0
   _Bool->0
auth/passwd.c:67:30: runtime error: member access within misaligned address 0x7f5823c3600e for type 'sudo_auth' (aka 'struct sudo_auth'), which requires 8 byte alignment
0x7f5823c3600e: note: pointer points here
 00 00 00 00 00 00  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  73 78 bd 23 58 7f 00 00  6a 00
             ^ 
SUMMARY: UndefinedBehaviorSanitizer: undefined-behavior auth/passwd.c:67:30 in 
auth/passwd.c:67:30: runtime error: load of misaligned address 0x7f5823c3601e for type 'void *', which requires 8 byte alignment
0x7f5823c3601e: note: pointer points here
 00 00 00 00 00 00  73 78 bd 23 58 7f 00 00  6a 00 00 00 05 00 00 00  73 78 bd 23 58 7f 00 00  6a 00
             ^ 
SUMMARY: UndefinedBehaviorSanitizer: undefined-behavior auth/passwd.c:67:30 in 
=================================================================
==1525==ERROR: AddressSanitizer: dynamic-stack-buffer-overflow on address 0x7ffcd6361d12 at pc 0x7f582396ea79 bp 0x7ffcd6361b20 sp 0x7ffcd6361b18
READ of size 1 at 0x7ffcd6361d12 thread T0
    #0 0x7f582396ea78 in sudo_passwd_verify /root/sudo-1.9.12/plugins/sudoers/./auth/passwd.c:73:9
    #1 0x7f582396b8e9 in verify_user /root/sudo-1.9.12/plugins/sudoers/./auth/sudo_auth.c:336:3
    #2 0x7f5823979240 in check_user_interactive /root/sudo-1.9.12/plugins/sudoers/./check.c:144:8
    #3 0x7f5823976a45 in check_user /root/sudo-1.9.12/plugins/sudoers/./check.c:217:11
    #4 0x7f5823a5ad24 in sudoers_policy_main /root/sudo-1.9.12/plugins/sudoers/./sudoers.c:578:13
    #5 0x7f5823a2f26d in sudoers_policy_check /root/sudo-1.9.12/plugins/sudoers/./policy.c:1180:11
    #6 0x559c76673753 in policy_check /root/sudo-1.9.12/src/./sudo.c:1227:10
    #7 0x559c76667319 in main /root/sudo-1.9.12/src/./sudo.c:262:11
    #8 0x7f58283a6d8f  (/lib/x86_64-linux-gnu/libc.so.6+0x29d8f) (BuildId: 69389d485a9793dbe873f0ea2c93e02efaa9aa3d)
    #9 0x7f58283a6e3f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x29e3f) (BuildId: 69389d485a9793dbe873f0ea2c93e02efaa9aa3d)
    #10 0x559c764ead84 in _start (/usr/local/bin/sudo+0xccd84) (BuildId: 5e779861424146e9069c64485d3c4414c868ddb8)

Address 0x7ffcd6361d12 is located in stack of thread T0
SUMMARY: AddressSanitizer: dynamic-stack-buffer-overflow /root/sudo-1.9.12/plugins/sudoers/./auth/passwd.c:73:9 in sudo_passwd_verify
Shadow bytes around the buggy address:
  0x10001ac64350: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x10001ac64360: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x10001ac64370: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x10001ac64380: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x10001ac64390: 00 00 00 00 00 00 00 00 00 00 00 00 ca ca ca ca
=>0x10001ac643a0: 00 02[cb]cb cb cb cb cb f1 f1 f1 f1 00 f2 f2 f2
  0x10001ac643b0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x10001ac643c0: f2 f2 f2 f2 00 00 00 00 00 00 00 00 00 00 00 00
  0x10001ac643d0: 00 00 00 00 f2 f2 f2 f2 00 00 00 00 00 00 00 00
  0x10001ac643e0: 00 00 00 00 00 00 00 00 00 00 00 f2 f2 f2 f2 f2
  0x10001ac643f0: f2 f2 f2 f2 00 00 00 00 00 00 00 00 00 00 00 00
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==1525==ABORTING
