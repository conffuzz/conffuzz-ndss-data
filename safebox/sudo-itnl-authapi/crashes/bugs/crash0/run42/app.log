Type list: passwd* char***
   passwd*->48
   char***->8
Type list: passwd* char* sudo_auth* sudo_conv_callback*
   passwd*->48
   char*->1
   sudo_auth*->80
   sudo_conv_callback*->32
Type list: passwd* int
   passwd*->48
   int->0
Type list: passwd* sudo_auth*
   passwd*->48
   sudo_auth*->80
Type list: passwd* _Bool
   passwd*->48
   _Bool->0
Type list: passwd* sudo_auth* _Bool
   passwd*->48
   sudo_auth*->80
   _Bool->0
Type list: passwd*
   passwd*->48
Type list: passwd* int _Bool
   passwd*->48
   int->0
   _Bool->0
Type list: passwd* char***
   passwd*->48
   char***->8
Type list: passwd* char* sudo_auth* sudo_conv_callback*
   passwd*->48
   char*->1
   sudo_auth*->80
   sudo_conv_callback*->32
Type list: passwd* int
   passwd*->48
   int->0
Type list: passwd* sudo_auth*
   passwd*->48
   sudo_auth*->80
Type list: passwd* _Bool
   passwd*->48
   _Bool->0
Type list: passwd* sudo_auth* _Bool
   passwd*->48
   sudo_auth*->80
   _Bool->0
Type list: passwd*
   passwd*->48
Type list: passwd* int _Bool
   passwd*->48
   int->0
   _Bool->0
Type list: passwd* char***
   passwd*->48
   char***->8
Type list: passwd* char* sudo_auth* sudo_conv_callback*
   passwd*->48
   char*->1
   sudo_auth*->80
   sudo_conv_callback*->32
Type list: passwd* int
   passwd*->48
   int->0
Type list: passwd* sudo_auth*
   passwd*->48
   sudo_auth*->80
Type list: passwd* _Bool
   passwd*->48
   _Bool->0
Type list: passwd* sudo_auth* _Bool
   passwd*->48
   sudo_auth*->80
   _Bool->0
Type list: passwd*
   passwd*->48
Type list: passwd* int _Bool
   passwd*->48
   int->0
   _Bool->0
Type list: passwd* char***
   passwd*->48
   char***->8
Type list: passwd* char* sudo_auth* sudo_conv_callback*
   passwd*->48
   char*->1
   sudo_auth*->80
   sudo_conv_callback*->32
Type list: passwd* int
   passwd*->48
   int->0
Type list: passwd* sudo_auth*
   passwd*->48
   sudo_auth*->80
Type list: passwd* _Bool
   passwd*->48
   _Bool->0
Type list: passwd* sudo_auth* _Bool
   passwd*->48
   sudo_auth*->80
   _Bool->0
Type list: passwd*
   passwd*->48
Type list: passwd* int _Bool
   passwd*->48
   int->0
   _Bool->0
Type list: passwd* char***
   passwd*->48
   char***->8
Type list: passwd* char* sudo_auth* sudo_conv_callback*
   passwd*->48
   char*->1
   sudo_auth*->80
   sudo_conv_callback*->32
Type list: passwd* int
   passwd*->48
   int->0
Type list: passwd* sudo_auth*
   passwd*->48
   sudo_auth*->80
Type list: passwd* _Bool
   passwd*->48
   _Bool->0
Type list: passwd* sudo_auth* _Bool
   passwd*->48
   sudo_auth*->80
   _Bool->0
Type list: passwd*
   passwd*->48
Type list: passwd* int _Bool
   passwd*->48
   int->0
   _Bool->0
Type list: passwd* char***
   passwd*->48
   char***->8
Type list: passwd* char* sudo_auth* sudo_conv_callback*
   passwd*->48
   char*->1
   sudo_auth*->80
   sudo_conv_callback*->32
Type list: passwd* int
   passwd*->48
   int->0
Type list: passwd* sudo_auth*
   passwd*->48
   sudo_auth*->80
Type list: passwd* _Bool
   passwd*->48
   _Bool->0
Type list: passwd* sudo_auth* _Bool
   passwd*->48
   sudo_auth*->80
   _Bool->0
Type list: passwd*
   passwd*->48
Type list: passwd* int _Bool
   passwd*->48
   int->0
   _Bool->0
Type list: passwd* char***
   passwd*->48
   char***->8
Type list: passwd* char* sudo_auth* sudo_conv_callback*
   passwd*->48
   char*->1
   sudo_auth*->80
   sudo_conv_callback*->32
Type list: passwd* int
   passwd*->48
   int->0
Type list: passwd* sudo_auth*
   passwd*->48
   sudo_auth*->80
Type list: passwd* _Bool
   passwd*->48
   _Bool->0
Type list: passwd* sudo_auth* _Bool
   passwd*->48
   sudo_auth*->80
   _Bool->0
Type list: passwd*
   passwd*->48
Type list: passwd* int _Bool
   passwd*->48
   int->0
   _Bool->0
Type list: passwd* char***
   passwd*->48
   char***->8
Type list: passwd* char* sudo_auth* sudo_conv_callback*
   passwd*->48
   char*->1
   sudo_auth*->80
   sudo_conv_callback*->32
Type list: passwd* int
   passwd*->48
   int->0
Type list: passwd* sudo_auth*
   passwd*->48
   sudo_auth*->80
Type list: passwd* _Bool
   passwd*->48
   _Bool->0
Type list: passwd* sudo_auth* _Bool
   passwd*->48
   sudo_auth*->80
   _Bool->0
Type list: passwd*
   passwd*->48
Type list: passwd* int _Bool
   passwd*->48
   int->0
   _Bool->0
Type list: passwd* char***
   passwd*->48
   char***->8
Type list: passwd* char* sudo_auth* sudo_conv_callback*
   passwd*->48
   char*->1
   sudo_auth*->80
   sudo_conv_callback*->32
Type list: passwd* int
   passwd*->48
   int->0
Type list: passwd* sudo_auth*
   passwd*->48
   sudo_auth*->80
Type list: passwd* _Bool
   passwd*->48
   _Bool->0
Type list: passwd* sudo_auth* _Bool
   passwd*->48
   sudo_auth*->80
   _Bool->0
Type list: passwd*
   passwd*->48
Type list: passwd* int _Bool
   passwd*->48
   int->0
   _Bool->0
Type list: passwd* char***
   passwd*->48
   char***->8
Type list: passwd* char* sudo_auth* sudo_conv_callback*
   passwd*->48
   char*->1
   sudo_auth*->80
   sudo_conv_callback*->32
Type list: passwd* int
   passwd*->48
   int->0
Type list: passwd* sudo_auth*
   passwd*->48
   sudo_auth*->80
Type list: passwd* _Bool
   passwd*->48
   _Bool->0
Type list: passwd* sudo_auth* _Bool
   passwd*->48
   sudo_auth*->80
   _Bool->0
Type list: passwd*
   passwd*->48
Type list: passwd* int _Bool
   passwd*->48
   int->0
   _Bool->0
Type list: passwd* char***
   passwd*->48
   char***->8
Type list: passwd* char* sudo_auth* sudo_conv_callback*
   passwd*->48
   char*->1
   sudo_auth*->80
   sudo_conv_callback*->32
Type list: passwd* int
   passwd*->48
   int->0
Type list: passwd* sudo_auth*
   passwd*->48
   sudo_auth*->80
Type list: passwd* _Bool
   passwd*->48
   _Bool->0
Type list: passwd* sudo_auth* _Bool
   passwd*->48
   sudo_auth*->80
   _Bool->0
Type list: passwd*
   passwd*->48
Type list: passwd* int _Bool
   passwd*->48
   int->0
   _Bool->0
getspwuid.c:101:26: runtime error: member access within misaligned address 0x60c00001159e for type 'const struct passwd', which requires 8 byte alignment
0x60c00001159e: note: pointer points here
 00 00 00 00 00 00  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  03 11 00 00 80 00 00 00  96 01
             ^ 
SUMMARY: UndefinedBehaviorSanitizer: undefined-behavior getspwuid.c:101:26 in 
getspwuid.c:101:26: runtime error: load of misaligned address 0x60c00001159e for type 'char *const', which requires 8 byte alignment
0x60c00001159e: note: pointer points here
 00 00 00 00 00 00  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  03 11 00 00 80 00 00 00  96 01
             ^ 
SUMMARY: UndefinedBehaviorSanitizer: undefined-behavior getspwuid.c:101:26 in 
=================================================================
==1113==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x60c00001159e at pc 0x7f079cdeafeb bp 0x7ffce1f46f90 sp 0x7ffce1f46f88
READ of size 8 at 0x60c00001159e thread T0
    #0 0x7f079cdeafea in sudo_getepw /root/sudo-1.9.12/plugins/sudoers/./getspwuid.c:101:26
    #1 0x7f079cdeb6b4 in sudo_passwd_init /root/sudo-1.9.12/plugins/sudoers/./auth/passwd.c:57:18
    #2 0x7f079cde5d31 in sudo_auth_init /root/sudo-1.9.12/plugins/sudoers/./auth/sudo_auth.c:117:15
    #3 0x7f079cdf31dc in check_user /root/sudo-1.9.12/plugins/sudoers/./check.c:183:9
    #4 0x7f079ced7d24 in sudoers_policy_main /root/sudo-1.9.12/plugins/sudoers/./sudoers.c:578:13
    #5 0x7f079ceac26d in sudoers_policy_check /root/sudo-1.9.12/plugins/sudoers/./policy.c:1180:11
    #6 0x563261f9e753 in policy_check /root/sudo-1.9.12/src/./sudo.c:1227:10
    #7 0x563261f92319 in main /root/sudo-1.9.12/src/./sudo.c:262:11
    #8 0x7f07a1828d8f  (/lib/x86_64-linux-gnu/libc.so.6+0x29d8f) (BuildId: 69389d485a9793dbe873f0ea2c93e02efaa9aa3d)
    #9 0x7f07a1828e3f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x29e3f) (BuildId: 69389d485a9793dbe873f0ea2c93e02efaa9aa3d)
    #10 0x563261e15d84 in _start (/usr/local/bin/sudo+0xccd84) (BuildId: 5e779861424146e9069c64485d3c4414c868ddb8)

0x60c00001159e is located 34 bytes to the left of 128-byte region [0x60c0000115c0,0x60c000011640)
freed by thread T0 here:
    #0 0x563261e98922 in free (/usr/local/bin/sudo+0x14f922) (BuildId: 5e779861424146e9069c64485d3c4414c868ddb8)
    #1 0x7f079ce0a1a4 in env_file_close_local /root/sudo-1.9.12/plugins/sudoers/./env.c:1216:2
    #2 0x7f079ce0385c in read_env_file /root/sudo-1.9.12/plugins/sudoers/./env.c:1362:5
    #3 0x7f079cdffaba in rebuild_env /root/sudo-1.9.12/plugins/sudoers/./env.c:914:11
    #4 0x7f079ced7d06 in sudoers_policy_main /root/sudo-1.9.12/plugins/sudoers/./sudoers.c:574:10
    #5 0x7f079ceac26d in sudoers_policy_check /root/sudo-1.9.12/plugins/sudoers/./policy.c:1180:11
    #6 0x563261f9e753 in policy_check /root/sudo-1.9.12/src/./sudo.c:1227:10
    #7 0x563261f92319 in main /root/sudo-1.9.12/src/./sudo.c:262:11
    #8 0x7f07a1828d8f  (/lib/x86_64-linux-gnu/libc.so.6+0x29d8f) (BuildId: 69389d485a9793dbe873f0ea2c93e02efaa9aa3d)

previously allocated by thread T0 here:
    #0 0x563261e98ff6 in __interceptor_realloc (/usr/local/bin/sudo+0x14fff6) (BuildId: 5e779861424146e9069c64485d3c4414c868ddb8)
    #1 0x7f07a1d7111a in sudo_parseln_v2 /root/sudo-1.9.12/lib/util/./parseln.c:108:17
    #2 0x7f079ce0a598 in env_file_next_local /root/sudo-1.9.12/plugins/sudoers/./env.c:1245:6
    #3 0x7f079ce03513 in read_env_file /root/sudo-1.9.12/plugins/sudoers/./env.c:1340:16
    #4 0x7f079cdffaba in rebuild_env /root/sudo-1.9.12/plugins/sudoers/./env.c:914:11
    #5 0x7f079ced7d06 in sudoers_policy_main /root/sudo-1.9.12/plugins/sudoers/./sudoers.c:574:10
    #6 0x7f079ceac26d in sudoers_policy_check /root/sudo-1.9.12/plugins/sudoers/./policy.c:1180:11
    #7 0x563261f9e753 in policy_check /root/sudo-1.9.12/src/./sudo.c:1227:10
    #8 0x563261f92319 in main /root/sudo-1.9.12/src/./sudo.c:262:11
    #9 0x7f07a1828d8f  (/lib/x86_64-linux-gnu/libc.so.6+0x29d8f) (BuildId: 69389d485a9793dbe873f0ea2c93e02efaa9aa3d)

SUMMARY: AddressSanitizer: heap-buffer-overflow /root/sudo-1.9.12/plugins/sudoers/./getspwuid.c:101:26 in sudo_getepw
Shadow bytes around the buggy address:
  0x0c187fffa260: 00 00 00 00 00 00 00 01 fa fa fa fa fa fa fa fa
  0x0c187fffa270: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 fa
  0x0c187fffa280: fa fa fa fa fa fa fa fa fd fd fd fd fd fd fd fd
  0x0c187fffa290: fd fd fd fd fd fd fd fa fa fa fa fa fa fa fa fa
  0x0c187fffa2a0: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fa
=>0x0c187fffa2b0: fa fa fa[fa]fa fa fa fa fd fd fd fd fd fd fd fd
  0x0c187fffa2c0: fd fd fd fd fd fd fd fd fa fa fa fa fa fa fa fa
  0x0c187fffa2d0: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fa
  0x0c187fffa2e0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c187fffa2f0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c187fffa300: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==1113==ABORTING
