Type list: passwd* char***
   passwd*->48
   char***->8
Type list: passwd* char* sudo_auth* sudo_conv_callback*
   passwd*->48
   char*->1
   sudo_auth*->80
   sudo_conv_callback*->32
Type list: passwd* int
   passwd*->48
   int->0
Type list: passwd* sudo_auth*
   passwd*->48
   sudo_auth*->80
Type list: passwd* _Bool
   passwd*->48
   _Bool->0
Type list: passwd* sudo_auth* _Bool
   passwd*->48
   sudo_auth*->80
   _Bool->0
Type list: passwd*
   passwd*->48
Type list: passwd* int _Bool
   passwd*->48
   int->0
   _Bool->0
Type list: passwd* char***
   passwd*->48
   char***->8
Type list: passwd* char* sudo_auth* sudo_conv_callback*
   passwd*->48
   char*->1
   sudo_auth*->80
   sudo_conv_callback*->32
Type list: passwd* int
   passwd*->48
   int->0
Type list: passwd* sudo_auth*
   passwd*->48
   sudo_auth*->80
Type list: passwd* _Bool
   passwd*->48
   _Bool->0
Type list: passwd* sudo_auth* _Bool
   passwd*->48
   sudo_auth*->80
   _Bool->0
Type list: passwd*
   passwd*->48
Type list: passwd* int _Bool
   passwd*->48
   int->0
   _Bool->0
Type list: passwd* char***
   passwd*->48
   char***->8
Type list: passwd* char* sudo_auth* sudo_conv_callback*
   passwd*->48
   char*->1
   sudo_auth*->80
   sudo_conv_callback*->32
Type list: passwd* int
   passwd*->48
   int->0
Type list: passwd* sudo_auth*
   passwd*->48
   sudo_auth*->80
Type list: passwd* _Bool
   passwd*->48
   _Bool->0
Type list: passwd* sudo_auth* _Bool
   passwd*->48
   sudo_auth*->80
   _Bool->0
Type list: passwd*
   passwd*->48
Type list: passwd* int _Bool
   passwd*->48
   int->0
   _Bool->0
Type list: passwd* char***
   passwd*->48
   char***->8
Type list: passwd* char* sudo_auth* sudo_conv_callback*
   passwd*->48
   char*->1
   sudo_auth*->80
   sudo_conv_callback*->32
Type list: passwd* int
   passwd*->48
   int->0
Type list: passwd* sudo_auth*
   passwd*->48
   sudo_auth*->80
Type list: passwd* _Bool
   passwd*->48
   _Bool->0
Type list: passwd* sudo_auth* _Bool
   passwd*->48
   sudo_auth*->80
   _Bool->0
Type list: passwd*
   passwd*->48
Type list: passwd* int _Bool
   passwd*->48
   int->0
   _Bool->0
Type list: passwd* char***
   passwd*->48
   char***->8
Type list: passwd* char* sudo_auth* sudo_conv_callback*
   passwd*->48
   char*->1
   sudo_auth*->80
   sudo_conv_callback*->32
Type list: passwd* int
   passwd*->48
   int->0
Type list: passwd* sudo_auth*
   passwd*->48
   sudo_auth*->80
Type list: passwd* _Bool
   passwd*->48
   _Bool->0
Type list: passwd* sudo_auth* _Bool
   passwd*->48
   sudo_auth*->80
   _Bool->0
Type list: passwd*
   passwd*->48
Type list: passwd* int _Bool
   passwd*->48
   int->0
   _Bool->0
Type list: passwd* char***
   passwd*->48
   char***->8
Type list: passwd* char* sudo_auth* sudo_conv_callback*
   passwd*->48
   char*->1
   sudo_auth*->80
   sudo_conv_callback*->32
Type list: passwd* int
   passwd*->48
   int->0
Type list: passwd* sudo_auth*
   passwd*->48
   sudo_auth*->80
Type list: passwd* _Bool
   passwd*->48
   _Bool->0
Type list: passwd* sudo_auth* _Bool
   passwd*->48
   sudo_auth*->80
   _Bool->0
Type list: passwd*
   passwd*->48
Type list: passwd* int _Bool
   passwd*->48
   int->0
   _Bool->0
Type list: passwd* char***
   passwd*->48
   char***->8
Type list: passwd* char* sudo_auth* sudo_conv_callback*
   passwd*->48
   char*->1
   sudo_auth*->80
   sudo_conv_callback*->32
Type list: passwd* int
   passwd*->48
   int->0
Type list: passwd* sudo_auth*
   passwd*->48
   sudo_auth*->80
Type list: passwd* _Bool
   passwd*->48
   _Bool->0
Type list: passwd* sudo_auth* _Bool
   passwd*->48
   sudo_auth*->80
   _Bool->0
Type list: passwd*
   passwd*->48
Type list: passwd* int _Bool
   passwd*->48
   int->0
   _Bool->0
Type list: passwd* char***
   passwd*->48
   char***->8
Type list: passwd* char* sudo_auth* sudo_conv_callback*
   passwd*->48
   char*->1
   sudo_auth*->80
   sudo_conv_callback*->32
Type list: passwd* int
   passwd*->48
   int->0
Type list: passwd* sudo_auth*
   passwd*->48
   sudo_auth*->80
Type list: passwd* _Bool
   passwd*->48
   _Bool->0
Type list: passwd* sudo_auth* _Bool
   passwd*->48
   sudo_auth*->80
   _Bool->0
Type list: passwd*
   passwd*->48
Type list: passwd* int _Bool
   passwd*->48
   int->0
   _Bool->0
Type list: passwd* char***
   passwd*->48
   char***->8
Type list: passwd* char* sudo_auth* sudo_conv_callback*
   passwd*->48
   char*->1
   sudo_auth*->80
   sudo_conv_callback*->32
Type list: passwd* int
   passwd*->48
   int->0
Type list: passwd* sudo_auth*
   passwd*->48
   sudo_auth*->80
Type list: passwd* _Bool
   passwd*->48
   _Bool->0
Type list: passwd* sudo_auth* _Bool
   passwd*->48
   sudo_auth*->80
   _Bool->0
Type list: passwd*
   passwd*->48
Type list: passwd* int _Bool
   passwd*->48
   int->0
   _Bool->0
Type list: passwd* char***
   passwd*->48
   char***->8
Type list: passwd* char* sudo_auth* sudo_conv_callback*
   passwd*->48
   char*->1
   sudo_auth*->80
   sudo_conv_callback*->32
Type list: passwd* int
   passwd*->48
   int->0
Type list: passwd* sudo_auth*
   passwd*->48
   sudo_auth*->80
Type list: passwd* _Bool
   passwd*->48
   _Bool->0
Type list: passwd* sudo_auth* _Bool
   passwd*->48
   sudo_auth*->80
   _Bool->0
Type list: passwd*
   passwd*->48
Type list: passwd* int _Bool
   passwd*->48
   int->0
   _Bool->0
Type list: passwd* char***
   passwd*->48
   char***->8
Type list: passwd* char* sudo_auth* sudo_conv_callback*
   passwd*->48
   char*->1
   sudo_auth*->80
   sudo_conv_callback*->32
Type list: passwd* int
   passwd*->48
   int->0
Type list: passwd* sudo_auth*
   passwd*->48
   sudo_auth*->80
Type list: passwd* _Bool
   passwd*->48
   _Bool->0
Type list: passwd* sudo_auth* _Bool
   passwd*->48
   sudo_auth*->80
   _Bool->0
Type list: passwd*
   passwd*->48
Type list: passwd* int _Bool
   passwd*->48
   int->0
   _Bool->0
getspwuid.c:101:26: runtime error: member access within misaligned address 0x60c0000112ab for type 'const struct passwd', which requires 8 byte alignment
0x60c0000112ab: note: pointer points here
 00  00 00 00 00 00 00 00 00  02 11 00 00 79 00 00 00  33 01 00 00 00 00 00 00  04 00 00 00 00 00 00
              ^ 
SUMMARY: UndefinedBehaviorSanitizer: undefined-behavior getspwuid.c:101:26 in 
getspwuid.c:101:26: runtime error: load of misaligned address 0x60c0000112ab for type 'char *const', which requires 8 byte alignment
0x60c0000112ab: note: pointer points here
 00  00 00 00 00 00 00 00 00  02 11 00 00 79 00 00 00  33 01 00 00 00 00 00 00  04 00 00 00 00 00 00
              ^ 
SUMMARY: UndefinedBehaviorSanitizer: undefined-behavior getspwuid.c:101:26 in 
=================================================================
==1104==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x60c0000112ab at pc 0x7ff70b861feb bp 0x7ffecdcdb2f0 sp 0x7ffecdcdb2e8
READ of size 8 at 0x60c0000112ab thread T0
    #0 0x7ff70b861fea in sudo_getepw /root/sudo-1.9.12/plugins/sudoers/./getspwuid.c:101:26
    #1 0x7ff70b8626b4 in sudo_passwd_init /root/sudo-1.9.12/plugins/sudoers/./auth/passwd.c:57:18
    #2 0x7ff70b85cd31 in sudo_auth_init /root/sudo-1.9.12/plugins/sudoers/./auth/sudo_auth.c:117:15
    #3 0x7ff70b86a1dc in check_user /root/sudo-1.9.12/plugins/sudoers/./check.c:183:9
    #4 0x7ff70b94ed24 in sudoers_policy_main /root/sudo-1.9.12/plugins/sudoers/./sudoers.c:578:13
    #5 0x7ff70b92326d in sudoers_policy_check /root/sudo-1.9.12/plugins/sudoers/./policy.c:1180:11
    #6 0x55addd0c4753 in policy_check /root/sudo-1.9.12/src/./sudo.c:1227:10
    #7 0x55addd0b8319 in main /root/sudo-1.9.12/src/./sudo.c:262:11
    #8 0x7ff71029ad8f  (/lib/x86_64-linux-gnu/libc.so.6+0x29d8f) (BuildId: 69389d485a9793dbe873f0ea2c93e02efaa9aa3d)
    #9 0x7ff71029ae3f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x29e3f) (BuildId: 69389d485a9793dbe873f0ea2c93e02efaa9aa3d)
    #10 0x55addcf3bd84 in _start (/usr/local/bin/sudo+0xccd84) (BuildId: 5e779861424146e9069c64485d3c4414c868ddb8)

0x60c0000112ab is located 21 bytes to the left of 121-byte region [0x60c0000112c0,0x60c000011339)
allocated by thread T0 here:
    #0 0x55addcfbedb8 in __interceptor_calloc (/usr/local/bin/sudo+0x14fdb8) (BuildId: 5e779861424146e9069c64485d3c4414c868ddb8)
    #1 0x7ff70ba02597 in sudo_make_pwitem /root/sudo-1.9.12/plugins/sudoers/./pwutil_impl.c:118:19
    #2 0x7ff70b9efb54 in sudo_getpwnam /root/sudo-1.9.12/plugins/sudoers/./pwutil.c:287:12
    #3 0x7ff70b94ab8d in init_vars /root/sudo-1.9.12/plugins/sudoers/./sudoers.c:913:22
    #4 0x7ff70b9478e0 in sudoers_init /root/sudo-1.9.12/plugins/sudoers/./sudoers.c:231:10
    #5 0x7ff70b864750 in sudoers_audit_open /root/sudo-1.9.12/plugins/sudoers/./audit.c:186:11
    #6 0x55addd0e5cfd in audit_open_int /root/sudo-1.9.12/src/./sudo.c:1600:11
    #7 0x55addd0bf526 in audit_open /root/sudo-1.9.12/src/./sudo.c:1619:11
    #8 0x55addd0b7f63 in main /root/sudo-1.9.12/src/./sudo.c:234:5
    #9 0x7ff71029ad8f  (/lib/x86_64-linux-gnu/libc.so.6+0x29d8f) (BuildId: 69389d485a9793dbe873f0ea2c93e02efaa9aa3d)

SUMMARY: AddressSanitizer: heap-buffer-overflow /root/sudo-1.9.12/plugins/sudoers/./getspwuid.c:101:26 in sudo_getepw
Shadow bytes around the buggy address:
  0x0c187fffa200: fd fd fd fd fd fd fd fa fa fa fa fa fa fa fa fa
  0x0c187fffa210: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fa
  0x0c187fffa220: fa fa fa fa fa fa fa fa fd fd fd fd fd fd fd fd
  0x0c187fffa230: fd fd fd fd fd fd fd fa fa fa fa fa fa fa fa fa
  0x0c187fffa240: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fa
=>0x0c187fffa250: fa fa fa fa fa[fa]fa fa 00 00 00 00 00 00 00 00
  0x0c187fffa260: 00 00 00 00 00 00 00 01 fa fa fa fa fa fa fa fa
  0x0c187fffa270: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 fa
  0x0c187fffa280: fa fa fa fa fa fa fa fa fd fd fd fd fd fd fd fd
  0x0c187fffa290: fd fd fd fd fd fd fd fa fa fa fa fa fa fa fa fa
  0x0c187fffa2a0: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==1104==ABORTING
